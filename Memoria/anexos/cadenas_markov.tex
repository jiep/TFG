\chapter{Cadenas de Markov}

\begin{defi}
Un proceso estocástico se define como una colección indexada de variables aleatorias $\{X_t\}$, donde el índice $t$ toma valores en un conjunto $T$ dado.  
\end{defi}

\begin{defi}
Las condiciones en las que puede estar un proceso estocástico se denominan estados. La variable aleatoria $X_t$ representa el estado del sistema en el tiempo $t$.
\end{defi}

\begin{defi}
Si $T$ es un conjunto conjunto discreto y el conjunto de estados es finito, entonces un proceso estocástico se dice que es de tiempo discreto con espacio de estados finito. 
\end{defi}

\begin{defi}
Un vector fila $\mathbf{p} = (p_1,p_2\dots,p_n)$ es un vector de probabilidad si todas sus componentes son no negativas y su suma es $1$, es decir,

\[ \sum\limits_{i=1}^{n} p_i = 1 \]
\end{defi}

\begin{ejemplo}
El vector $\mathbf{p} = (1/2, 1/4, 1/5, 19/30)$ es un vector de probabilidad porque $\frac{1}{2} + \frac{1}{4} + \frac{1}{5} + \frac{19}{30} = 1$, y todas sus componentes son mayores o iguales que $1$. \\
Sin embargo, el vector $\mathbf{q} = (1, 1/2, -2, 1/2)$ no es un vector de probabilidad porque tiene una componente negativa, $-2$.
\end{ejemplo}

\begin{defi}
Una matriz cuadrada $\mathbf{A} = (a_{ij})$ de tamaño $n \times n$ se dice estocástica si cada una de sus filas es un vector de probabilidad, es decir, si cada cada entrada de $\mathbf{A}$ es no negativa y la suma de las entradas de cada fila es $1$.
\end{defi}

\begin{ejemplo}
La siguiente matriz es una matriz estocástica 

\[\mathbf{A} = \left(\begin{array}{ccc}
1/2 & 1/2 & 0\\
0   & 2/3 & 1/3\\
1   &  0  & 0
\end{array}\right) \]

porque todas sus filas son vectores de probabilidad.
\end{ejemplo}

\begin{defi}
Una matriz estocástica $\mathbf{A}$ se dice regular si todas las entradas de $\mathbf{A}^n$ son positivas, para algún $n \in \N$.
\end{defi}

\begin{ejemplo}
La matriz estocástica

\[ \mathbf{A} = \left(\begin{array}{cc}
0 & 1\\
1/2 & 1/2
\end{array}\right) \]

es regular porque 

\[ \mathbf{A}^2 = \left(\begin{array}{cc}
1/2 & 1/2\\
1/4 & 3/4
\end{array}\right) \]

tiene cada entrada positiva.\\
Sin embargo, la matriz estocástica

\[ \mathbf{B} = \left(\begin{array}{cc}
1 & 0\\
1/2 & 1/2
\end{array}\right) \]

no es regular porque

\[ \mathbf{B}^2 = \left(\begin{array}{cc}
1 & 0\\
3/4 & 1/4
\end{array}\right) \]

tiene una entrada que no es positiva.
\end{ejemplo}

\begin{defi}
Un punto fijo $\mathbf{p}^*$ de una matriz estocástica $\mathbf{A}$ se define como la solución de la ecuación

\[ \mathbf{p}^* \mathbf{A} = \mathbf{p}^* \]
\end{defi}

\begin{ejemplo}
Si consideramos las matriz estocástica regular

\[ \mathbf{A} = \left(\begin{array}{ccc}
0 & 1 & 0\\
0 & 0 & 1\\
1/2 & 1/2 & 0
\end{array}\right) \]

El punto fijo $\mathbf{p}^* = (x,y,z)$ tiene que cumplir que $x+y+z = 1$, y $x,y,z \in [0,1]$. Resolviendo el sistema $\mathbf{p}^* \mathbf{A} = \mathbf{p}^*$, resulta que el punto fijo $p^* = (1/5, 2/5, 2/5)$.
\end{ejemplo}

\begin{teo}
Sea $\mathbf{A}$ una matriz estocástica regular. Entonces

\begin{enumerate}
\item $\mathbf{A}$ tiene un único vector de probabilidad $\mathbf{p}$, y todas las componentes de $\mathbf{p}$ son positivas.
\item La secuencias de matrices de potencias de $\mathbf{A}$, $\mathbf{A},\mathbf{A}^2,\mathbf{A}^3,\dots$ aproxima la matriz $\mathbf{B}$ cuyas filas están compuestas por el punto fijo $\mathbf{p}^*$.
\item Si $\mathbf{p}$ es un vector de probabilidad, entonces la secuencia $\mathbf{p A}, \mathbf{p} \mathbf{A}^2,\mathbf{p} \mathbf{A}^3,\dots$ aproxima el punto fijo $\mathbf{p}^*$.
\end{enumerate}
\end{teo}

\begin{defi}
Se dice que un proceso estocástico $\{X_t\}$ tiene la propiedad de Markov si 

\[ P(X_{t+1} = j | X_0 = k_0, X_1 = k_1,\dots, X_{t-1} = k_{t-1}, X_t = i) = P(X_{t+1} = j | X_t = j)\]

para todo $t$, y toda sucesión $i, k_0, k1, \dots, k_{t-1}$. Es decir, la probabilidad de un suceso futuro, sólo depende del evento actual. 
\end{defi}

\begin{defi}
Un proceso estocástico $\{X_t\}$ es una cadena de Markov si presenta la propiedad de Markov.
\end{defi}

\begin{defi}
Las probabilidades condicionales $P(X_{t+1 = j} | X_t = i)$ de una cadena de Markov se llaman probabilidades de transición.
\end{defi}

\begin{defi}
Si dada una cadena de Markov, y para cada $i, j$ se cumple que 

\[ P(X_{t+1} | X_t = i) = P(X_1 = j | X_0 = i) \quad \text{para todo $t=1,2,...$} \]

se dice que las probabilidades son estacionarias.
\end{defi}

Las probabilidades estacionarias se denotan de la siguiente manera:

\begin{eqnarray}
p_{ij} = P(X_{t+1} = j | X_t = i)\\
p_{ij}^{(n)} = P(X_{t+n} = j | X_t = i)
\end{eqnarray}

Las probabilidades estacionarias se pueden representan mediante una matriz estocástica de la siguiente manera:

\[ \mathbf{P}^{(n)} = \left(\begin{array}{c c c c}
p_{11}^{(n)} & p_{12}^{(n)} & \dots & p_{1M}^{(n)}\\
p_{21}^{(n)} & p_{22}^{(n)} & \dots & p_{2M}^{(n)}\\
\dots        & \dots        & \dots & \dots\\
p_{M1}^{(n)} & p_{M2}^{(n)} & \dots & p_{MM}^{(n)}  
\end{array}\right) \]

donde $M$ es el número de estados de la cadena de Markov. Esta matriz se denomina matriz de transición.\\

Otra posible representación es mediante un grafo ponderado, cuyo peso es la probabilidad de ir del estado $i$ al estado $j$. Este grafo se denomina diagrama de  de transición de estados.

\begin{ejemplo} \label{ej:markov}
Si tenemos la cadena de Markov con el conjunto de estados $S = \{A,B,C\}$, y la matriz de transición $\mathbf{P}$ definida como

\[ \mathbf{P} = \left(\begin{array}{cccc}
  &   A  &   B  &  C \\
A & 0.65 & 0.3  & 0.05\\
B & 0.1  & 0.75 & 0.15\\
C & 0.01 & 0.19 & 0.8
\end{array}\right) \] 

El diagrama de transiciones de estados se puede ver en la Figura \ref{fig:markov}.

\begin{figure}[htb]
\centering
\ejemplomarkov
\caption{Diagrama de transición de estados del Ejemplo \ref{ej:markov}}
\label{fig:markov}
\end{figure}
\end{ejemplo}

Las ecuaciones de Chapman-Kolmogorov proporcionan un método para calcular las probabilidades de transición de $n$ pasos $p_{ij}^{(n)}$:

\begin{equation}
p_{ij}^{(n)} = \sum\limits_{k=1}^{M-1} p_{ik}^{(m)}p_{kj}^{(n-m)} \quad \forall i,j = 1,\dots M
\end{equation}

donde $M$ es el número de estados de la cadena de Markov. \\

En los casos especiales $m=1$ y $m = n-1$ se obtienen las siguientes expresiones:

\begin{eqnarray}
p_{ij}^{(n)} = \sum\limits_{k=1}^{M-1} p_{ik}p_{kj}^{(n-1)}\\
p_{ij}^{(n)} = \sum\limits_{k=1}^{M-1} p_{ik}^{n-1}p_{kj}\\
\end{eqnarray}

Estas dos ecuaciones permiten calcular la matriz $\mathbf{P}^n$ de transiciones ya que 

\begin{align*}
\mathbf{P}^{(n)} & = \mathbf{P} \mathbf{P}^{(n-1)} = \mathbf{P}^{(n-1)} \mathbf{P}\\
				 & = \mathbf{P} \mathbf{P}^{n-1} = \mathbf{P}^{n-1} \mathbf{P} \\
				 & = \mathbf{P}^n 
\end{align*} 

Esto permite descomponer la matriz $\mathbf{P}^n$, como $\mathbf{P}^n = \mathbf{H} \mathbf{J}^n \mathbf{H}^{-1}$, donde $J$ es la matriz de Jordan, diagonal por cajas formada por los autovalores de $\mathbf{P}$ y $\mathbf{H}$ es una matriz invertible cuyas columnas son los autovectores de $\mathbf{P}$ asociados a los autovalores.

\todo[backgroundcolor=red, inline]{Añadir clasifiación de las cadenas de Markov}